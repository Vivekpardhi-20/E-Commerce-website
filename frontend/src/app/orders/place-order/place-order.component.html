<div class="checkout-container">
  <h2>Place Order</h2>

  <!-- Cart Summary -->
  <div class="cart-summary" *ngIf="cart?.items?.length">
    <h3>Order Summary</h3>
    <table>
      <thead>
        <tr>
          <th>Product</th>
          <th>Qty</th>
          <th>Price</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of cart.items">
          <td>{{ item.product.name }}</td>
          <td>{{ item.quantity }}</td>
          <td>₹{{ item.product.price }}</td>
          <td>₹{{ item.product.price * item.quantity }}</td>
        </tr>
      </tbody>
    </table>
    <div class="grand-total">
      <strong>Grand Total: ₹{{ cart.total }}</strong>
    </div>
  </div>

  <!-- Shipping Address Form -->
  <div class="address-form">
    <h3>Shipping Address</h3>
    <form (ngSubmit)="placeOrder()" #checkoutForm="ngForm">
      
  <label for="addressLine1">Address Line 1 *</label>
  <input id="addressLine1" type="text" [(ngModel)]="addressLine1" name="addressLine1" required minlength="4" #addressLine1Ref="ngModel" />
      <div class="error" *ngIf="addressLine1Ref.invalid && addressLine1Ref.touched">
        <small *ngIf="addressLine1Ref.errors?.['required']">Address Line 1 is required.</small>
        <small *ngIf="addressLine1Ref.errors?.['minlength']">Minimum 4 characters required.</small>
      </div>

  <label for="addressLine2">Address Line 2</label>
  <input id="addressLine2" type="text" [(ngModel)]="addressLine2" name="addressLine2" />

  <label for="city">City *</label>
  <input id="city" type="text" [(ngModel)]="city" name="city" required minlength="2" #cityRef="ngModel" />
      <div class="error" *ngIf="cityRef.invalid && cityRef.touched">
        <small *ngIf="cityRef.errors?.['required']">City is required.</small>
        <small *ngIf="cityRef.errors?.['minlength']">Minimum 2 characters required.</small>
      </div>

  <label for="state">State *</label>
  <input id="state" type="text" [(ngModel)]="state" name="state" required minlength="2" #stateRef="ngModel" />
      <div class="error" *ngIf="stateRef.invalid && stateRef.touched">
        <small *ngIf="stateRef.errors?.['required']">State is required.</small>
        <small *ngIf="stateRef.errors?.['minlength']">Minimum 2 characters required.</small>
      </div>

      <!-- ✅ Postal Code Validation -->
      <label for="postalCode">Postal Code *</label>
      <input 
        id="postalCode"
        type="text" 
        [(ngModel)]="postalCode" 
        name="postalCode" 
        required 
        pattern="^[0-9]{6}$" 
        maxlength="6"
        #postalCtrl="ngModel"
      />

      <!-- Error messages -->
      <div class="error" *ngIf="postalCtrl.invalid && postalCtrl.touched">
        <small *ngIf="postalCtrl.errors?.['required']">Postal code is required.</small>
        <small *ngIf="postalCtrl.errors?.['pattern']">Postal code must be exactly 6 digits.</small>
      </div>

  <label for="paymentMethod">Payment Method</label>
  <select id="paymentMethod" [(ngModel)]="paymentMethod" name="paymentMethod" required #paymentMethodRef="ngModel">
        <option [ngValue]="'COD'">Cash on Delivery</option>
        <option [ngValue]="'CARD'">Credit/Debit Card</option>
      </select>

      <div class="error" *ngIf="paymentMethodRef.invalid && paymentMethodRef.touched">
        <small *ngIf="paymentMethodRef.errors?.['required']">Payment method is required.</small>
      </div>

      <button type="submit" [disabled]="!checkoutForm.form.valid">Place Order</button>
    </form>
  </div>
</div>
